# In order to edit this file more easily in VS Code, please install this extension:
# https://marketplace.visualstudio.com/items?itemName=GraphQL.vscode-graphql
# You'll need to restart VS Code after doing so.

query project_v2_issues($org: String!, $projectNumber: Int!, $cursor: String) {
    rateLimit {
        limit
        cost
        remaining
        resetAt
    }
    organization(login: $org) {
        projectV2(number: $projectNumber) {
            items(first: 50, after: $cursor) {
                # Type: ProjectV2ItemConnection!
                totalCount
                pageInfo {
                    hasNextPage
                    endCursor
                }
                nodes {
                    # Type: ProjectV2Item
                    id
                    content {
                        ... on Issue {
                            number
                            title
                            url
                            closed # issues can only be open or closed!
                            milestone {
                                title
                            }
                        }
                        # Info: Other types are DraftIssue and PullRequest
                    }
                    fieldValues(first: 99) {
                        nodes {
                            # Union: ProjectV2ItemFieldValue
                            # Can be one of those:
                            # ProjectV2ItemFieldDateValue
                            # ProjectV2ItemFieldIterationValue
                            # ProjectV2ItemFieldLabelValue
                            # ProjectV2ItemFieldMilestoneValue
                            # ProjectV2ItemFieldNumberValue
                            # ProjectV2ItemFieldPullRequestValue
                            # ProjectV2ItemFieldRepositoryValue
                            # ProjectV2ItemFieldReviewerValue
                            # ProjectV2ItemFieldSingleSelectValue
                            # ProjectV2ItemFieldTextValue
                            # ProjectV2ItemFieldUserValue

                            ... on ProjectV2ItemFieldSingleSelectValue {
                                field {
                                    ... on ProjectV2FieldCommon {
                                        id
                                        name
                                    }
                                }
                                name
                            }
                            ... on ProjectV2ItemFieldTextValue {
                                field {
                                    ... on ProjectV2FieldCommon {
                                        id
                                        name
                                    }
                                }
                                text
                            }
                            ... on ProjectV2ItemFieldDateValue {
                                field {
                                    ... on ProjectV2FieldCommon {
                                        id
                                        name
                                    }
                                }
                                date
                            }
                            ... on ProjectV2ItemFieldIterationValue {
                                field {
                                    ... on ProjectV2FieldCommon {
                                        id
                                        name
                                    }
                                }
                                title
                            }
                            ... on ProjectV2ItemFieldNumberValue {
                                field {
                                    ... on ProjectV2FieldCommon {
                                        id
                                        name
                                    }
                                }
                                number
                            }
                        }
                    }
                }
            }
        }
    }
}
